"use strict";function capitalize(a){return a.charAt(0).toUpperCase()+a.slice(1)}function formatDuration(a){var b=a.replace(/\./g,":"),c=b.indexOf(":");return c>=0?b.substr(c+1).length<=1&&(b=b.substr(0,c+1)+"0"+b.substr(c+1)):b+=":00",b}var app=angular.module("smartUpApp",["ngSanitize","ngRoute","ngAutocomplete","ngMessages","firebase","ui.bootstrap","angular-md5","gettext","tmh.dynamicLocale"]);app.constant("CFG",{APP_NAME:"smartUp",APP_FULLNAME:"Sistemi Solari Rossi",APP_LOGO:"icons/logo.png",FIREBASE_URL:"https://smartup.firebaseio.com/",SYSTEM_EMAIL:"sistemisolarirossi@gmail.com",APPCACHE:!1,DEBUG:!0}),app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html",controller:"AuthCtrl"}).when("/register",{templateUrl:"views/register.html",controller:"AuthCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"AuthCtrl"}).when("/login/:authType",{templateUrl:"views/login.html",controller:"AuthCtrl"}).when("/customers",{templateUrl:"views/customers.html",controller:"CustomersCtrl"}).when("/orders",{templateUrl:"views/orders.html",controller:"OrdersCtrl"}).when("/orders/:orderId",{templateUrl:"views/showorder.html",controller:"OrderViewCtrl"}).when("/servicereports",{templateUrl:"views/serviceReports.html",controller:"ServicereportsCtrl"}).when("/contacts",{templateUrl:"views/contacts.html",controller:"ContactsCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/users",{templateUrl:"views/users.html",controller:"UsersCtrl"}).when("/users/:username",{templateUrl:"views/users.html",controller:"UsersCtrl"}).otherwise({redirectTo:"/"})}]),app.config(["datepickerConfig","datepickerPopupConfig",function(a,b){b.showButtonBar=!1}]),app.config(["tmhDynamicLocaleProvider",function(a){var b="scripts/i18n/angular-locale_{{locale}}.js";a.localeLocationPattern(b)}]),app.run(["$rootScope","CFG","I18N",function(a,b,c){a.appName=b.APP_NAME,a.appLogo=b.APP_LOGO,a.today=new Date,c.setCurrentLanguage()}]),app.run(["$templateCache",function(a){a.put("template/timepicker/timepicker.html",'<table> <tbody>   <tr>     <td style="width: 3.0em;" class="form-group" ng-class="{\'has-error\': invalidHours}">       <input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">     </td>     <td></td>     <td style="width: 3.0em;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">       <input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">     </td>     <td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>   </tr> </tbody></table>')}]),app.run(["$window","$rootScope",function(a,b){b.online=navigator.onLine,a.addEventListener("offline",function(){console.info("* GONE OFFLINE *"),b.$apply(function(){b.online=!1})},!1),a.addEventListener("online",function(){console.info("* GONE ONLINE *"),b.$apply(function(){b.online=!0})},!1)}]),app.run(["$window","$rootScope","gettext","CFG",function(a,b,c,d){d.APPCACHE&&(b.appcache={},b.appcache.status=c("initializing"),a.applicationCache.addEventListener("error",function(a){b.$apply(function(){b.appcache.status=c("error"),console.info("% appcache status: "+b.appcache.status+" %",a)})},!1),a.applicationCache.addEventListener("cached",function(){b.$apply(function(){b.appcache.status=c("cached"),console.info("% appcache status: "+b.appcache.status+" %")})},!1),a.applicationCache.addEventListener("checking",function(){b.$apply(function(){b.appcache.status=c("checking"),console.info("% appcache status: "+b.appcache.status+" %")})},!1),a.applicationCache.addEventListener("downloading",function(){b.$apply(function(){b.appcache.status=c("downloading"),console.info("% appcache status: "+b.appcache.status+" %")})},!1),a.applicationCache.addEventListener("noupdate",function(){b.$apply(function(){b.appcache.status=c("cached"),console.info("% appcache status: "+b.appcache.status+" %")})},!1),a.applicationCache.addEventListener("obsolete",function(){b.$apply(function(){b.appcache.status=c("obsolete"),console.info("% appcache status: "+b.appcache.status+" %")})},!1),a.applicationCache.addEventListener("progress",function(){b.$apply(function(){b.appcache.status=c("progress"),console.info("% appcache status: "+b.appcache.status+" %")})},!1),a.applicationCache.addEventListener("updateready",function(){b.$apply(function(){b.appcache.status=c("updateready"),console.info("% appcache status: "+b.appcache.status+" %")})},!1))}]),app.run(["$window",function(a){var b=function(){console.log("Functionality to run before printing")},c=function(){console.log("Functionality to run after printing")};if(a.matchMedia){var d=a.matchMedia("print");d.addListener(function(a){a.matches?b():c()})}a.onbeforeprint=b,a.onafterprint=c}]);var lastBuildDate="2014-10-05 21:08:27";angular.module("gettext").run(["gettextCatalog",function(a){a.setStrings("de",{"(hh:mm)":"(hh : mm)","A Codice Fiscale or a P.IVA is required":"Ein Codice Fiscale oder ein P.IVA erforderlich","A customer name is required":"Ein Kunde Name ist erforderlich","A date of service start is required":"Ein Datum der Zustellung Start erforderlich","A location of service is required":"Ein Ort, der Dienst ist erforderlich","A phone number is required":"Eine Telefonnummer ist erforderlich","A street address is required":"Eine Adresse ist erforderlich","A user name is required":"Ein Benutzername ist erforderlich",About:"ÃÂÃÂ¼ber","Add new customer":"FÃÂÃÂ¼gen Sie neue Kunden","Add new user":"Neuen Benutzer hinzufÃÂÃÂ¼gen",Address:"Adresse","An email address is required":"Eine E-Mail -Adresse ist erforderlich","An operator is required":"Ein Operator wird benÃÂÃÂ¶tigt","An update is available: do you want to load it now?":"Ein Update ist verfÃÂÃÂ¼gbar : Wollen Sie es jetzt laden?","An update is ready":"Ein Update ist fertig","Are you really sure to remove service report":"Sind Sie wirklich sicher, dass Sie Service- Bericht zu entfernen","Are you really sure to remove user":"Sind Sie wirklich sicher, dass Sie Benutzer entfernen","Authentication id":"Authentifizierungs-ID","Authentication id of the user":"Authentifizierungs-ID des Benutzers,","Authentication id:":"Authentifizierungs-ID :","Authentication provider":"Authentifizierungsanbieter","Authentication provider for the user":"Authentifizierungsanbieter fÃÂÃÂ¼r den Nutzer",Avatar:"Avatar","Avatar image of the user":"Avatar Bild des Benutzers","C.F./P.IVA":"C.F. / P.IVA","Cache is being initialized":"Cache initialisiert wird","Cache is in unknown state":"Cache ist in unbekannten Zustand","Cache is not updated (probably the manifest is unreachable)":"Cache nicht aktualisiert wird (wahrscheinlich das Manifest nicht erreichbar ist )","Cache is not updated because you are offline":"Cache wird nicht aktualisiert, da Sie offline sind","Cache is obsolete":"Cache ist veraltet","Cache is up-to-date":"Cache ist up- to-date","Cache status is":"Cache-Status ist","Checking for the presence of an update":"PrÃÂÃÂ¼fung auf das Vorhandensein eines Aktualisierungs","Codice Fiscale / P.IVA":"Codice Fiscale / P.IVA","Codice Fiscale contains invalid character(s)":"Codice Fiscale enthÃÂÃÂ¤lt ungÃÂÃÂ¼ltige Zeichen ( s )","Codice Fiscale control code doesn't match":"Codice Fiscale Steuercode passt nicht","Codice Fiscale or P.IVA of the customer":"Codice Fiscale oder P.IVA des Kunden","Company logo":"Firmenlogo","Connect with Facebook":"Verbinden mit Facebook","Connect with Google+":"Verbinden mit Google+","Connect with Twitter":"Verbinden mit Twitter",Contacts:"Kontakte","Current language is":"Aktuelle Sprache ist",Customer:"Kunde","Customer Card":"Kundenkarte","Customer email address":"Kunde E-Mail Adresse","Customer name":"Kundenname","Customer phone number":"Kundentelefonnummer","Customer street address":"Kunden Adresse","Customer's signature":"Unterschrift des Kunden",Customers:"Kundschaft",Date:"Datum","Date of service start":"Datum der Zustellung Start","Delete customer":"Kunden lÃÂÃÂ¶schen","Delete service report":"LÃÂÃÂ¶schen Servicebericht","Delete user":"Benutzer lÃÂÃÂ¶schen","Downloading an update":"Einspielen eines Updates",Duration:"Dauer","Duration of service":"Dauer des Dienstleistungs","Edit customer":"Kunden bearbeiten","Edit service report":"Bearbeiten Servicebericht","Edit user":"Benutzer bearbeiten",Email:"E-Mail-","Email address":"E-Mail-Addresse","Email address is not valid":"E-Mail -Adresse ist ungÃÂÃÂ¼ltig","Email address of the user":"E-Mail -Adresse des Benutzers","Email of the user":"E-Mail des Benutzers",Fax:"Fax","Filter customers":"Filter Kunden","Filter service reports":"Filter Serviceberichte","Filter users":"Filter Benutzer","Hello dogs !":"Hallo Hunde!",Home:"Zuhause",Id:"Identifikation","It allows the management of customers, orders and service reports.":"Es ermöglicht die Verwaltung von Kunden, Bestellungen und Serviceberichte .",Location:"Lage","Location of service":"Ort der Dienstleistung","Log in":"Anmelden","Log out":"ausloggen",N:"N",Name:"Name","Name of the user":"Name des Benutzers","New customer":"neuer Kunde","New report":"neuer Bericht","New user":"neuer Benutzer","No update is present":"Kein Update vorhanden ist",Notes:"Aufzeichnungen",Number:"Anzahl",Operator:"Betreiber","Operator of service":"Betreiber von Service","Operator's signature":"Betreiber Unterschrift",Orders:"Bestellungen","P.IVA":"P.IVA","P.IVA contains invalid character(s)":"P.IVA enthÃÂÃÂ¤lt ungÃÂÃÂ¼ltige Zeichen ( s )","P.IVA control code doesn't match":"P.IVA Steuercode passt nicht",Phone:"Telefon","Phone number":"Telefonnummer","Phone number is not valid":"Telefonnummer ist nicht gÃÂÃÂ¼ltig",Place:"Ort","Preparing the downloading an update":"Vorbereiten des Einspielen eines Updates",Print:"drucken","Print customer":"Druckkunden","Print service report":"Druckservicebericht","Print user":"Druck Benutzer",Provider:"Versorger",Register:"Registrieren",Roles:"Rollen",Save:"Speichern","Service report":"Servicebericht","Service report n":"Servicebericht n","Service reports":"Serviceberichte",Setup:"Setup","Street address":"Adresse","This customer name is already in use":"Diese Kundenname wird bereits verwendet","This customer name is not valid":"Diese Kundenname ist ungÃÂÃÂ¼ltig","This is":"Dies ist","This user can nor read nor write":"Dieser Benutzer kann noch lesen noch schreiben","This user can read":"Dieser Nutzer lesen kÃÂÃÂ¶nnen","This user can read and write":"Dieser Benutzer kann lesen und schreiben","This user can write":"Dieser Benutzer schreiben kÃÂÃÂ¶nnen","This user can't access":"Dieser Benutzer nicht zugreifen kann","This user name is already in use":"Dieser Benutzername ist bereits im Einsatz","This user name is not valid":"Dieser Benutzername ist nicht gÃÂÃÂ¼ltig","This value is nor a Codice Fiscale nor a P.IVA":"Dieser Wert ist noch ein Codice Fiscale noch ein P.IVA","Time of service start":"Wenn ein Service Start","Toggle navigation":"Toggle Navigation","User email address":"Benutzer E-Mail Adresse","User name":"Benutzername",Username:"Benutzername",Users:"Benutzer","You are offline":"Sie sind offline","You are online":"Sie sind online",cached:"zwischengespeichert",cancel:"stornieren",checking:"ÃÂÃÂberprÃÂÃÂ¼fung",customers:"Kundschaft",downloading:"Download",error:"Fehler","home page for non registered users.":"Homepage fÃÂÃÂ¼r nicht registrierte Nutzer.","home page for registerd users.":"Homepage fÃÂÃÂ¼r registerd Nutzer.",initializing:"Initialisierung","is a web application for (smart) start-ups.":"ist eine Web -Anwendung fÃÂÃÂ¼r ( smart) Start-ups.","logged user":"angemeldeten Benutzer",obsolete:"obsolet",orders:"Bestellungen","otherwise register a new accout and log in.":"ansonsten registrieren Sie einen neuen Kunden-Account und melden Sie sich an.","password:":"Passwort :",progress:"Fortschritt",servicereports:"servicereports",updateready:"updateready","username:":"Benutzername :",users:"Benutzer","Hello babe":"Hallo Babe"}),a.setStrings("es",{"(hh:mm)":"( hh : mm )","A Codice Fiscale or a P.IVA is required":"Se requiere un cÃÂÃÂ³digo fiscal o un P.IVA","A customer name is required":"Se requiere un nombre de cliente","A date of service start is required":"Se requiere una fecha de inicio del servicio","A location of service is required":"Se requiere una ubicaciÃÂÃÂ³n de servicio","A phone number is required":"Se requiere un nÃÂÃÂºmero de telÃÂÃÂ©fono","A street address is required":"Se requiere una direcciÃÂÃÂ³n de la calle","A user name is required":"Se requiere un nombre de usuario",About:"Acerca de","Add new customer":"AÃÂÃÂ±adir nuevo cliente","Add new user":"AÃÂÃÂ±adir un nuevo usuario",Address:"DirecciÃÂÃÂ³n","An email address is required":"Se requiere una direcciÃÂÃÂ³n de email","An operator is required":"Se requiere un operador","An update is available: do you want to load it now?":"Hay disponible una actualizaciÃÂÃÂ³n : QuÃÂÃÂ© quiere cargar ahora ?","An update is ready":"Una actualizaciÃÂÃÂ³n estÃÂÃÂ¡ lista","Are you really sure to remove service report":"ÃÂÃÂ¿EstÃÂÃÂ¡s realmente seguro de quitar informe de servicio","Are you really sure to remove user":"ÃÂÃÂ¿EstÃÂÃÂ¡s realmente seguro de quitar al usuario","Authentication id":"IdentificaciÃÂÃÂ³n de autenticaciÃÂÃÂ³n","Authentication id of the user":"IdentificaciÃÂÃÂ³n de autenticaciÃÂÃÂ³n del usuario","Authentication id:":"IdentificaciÃÂÃÂ³n de autenticaciÃÂÃÂ³n:","Authentication provider":"proveedor de autenticaciÃÂÃÂ³n","Authentication provider for the user":"Proveedor de autenticaciÃÂÃÂ³n para el usuario",Avatar:"Avatar","Avatar image of the user":"Imagen de avatar del usuario","C.F./P.IVA":"C. F. / P.IVA","Cache is being initialized":"Se inicializa cachÃÂÃÂ©","Cache is in unknown state":"CachÃÂÃÂ© estÃÂÃÂ¡ en estado desconocido","Cache is not updated (probably the manifest is unreachable)":"CachÃÂÃÂ© no se actualiza (probablemente el manifiesto es inalcanzable )","Cache is not updated because you are offline":"CachÃÂÃÂ© no se actualiza porque estÃÂÃÂ¡ fuera de lÃÂÃÂ­nea","Cache is obsolete":"CachÃÂÃÂ© es obsoleta","Cache is up-to-date":"CachÃÂÃÂ© es up-to- fecha","Cache status is":"Estado de cachÃÂÃÂ© es","Checking for the presence of an update":"ComprobaciÃÂÃÂ³n de la presencia de una actualizaciÃÂÃÂ³n","Codice Fiscale / P.IVA":"CÃÂÃÂ³digo fiscal / P.IVA","Codice Fiscale contains invalid character(s)":"CÃÂÃÂ³digo fiscal contiene caracteres no vÃÂÃÂ¡lidos ( s )","Codice Fiscale control code doesn't match":"CÃÂÃÂ³digo de control de cÃÂÃÂ³digo fiscal no coincide","Codice Fiscale or P.IVA of the customer":"CÃÂÃÂ³digo fiscal o P.IVA del cliente","Company logo":"logotipo de la empresa","Connect with Facebook":"ConÃÂÃÂ©ctate con Facebook","Connect with Google+":"Conecte con Google+","Connect with Twitter":"ConÃÂÃÂ©ctate con Twitter",Contacts:"Contactos","Current language is":"El idioma actual es",Customer:"cliente","Customer Card":"Tarjeta Cliente","Customer email address":"DirecciÃÂÃÂ³n de correo electrÃÂÃÂ³nico del cliente","Customer name":"nombre del cliente","Customer phone number":"NÃÂÃÂºmero de telÃÂÃÂ©fono del cliente","Customer street address":"DirecciÃÂÃÂ³n de la calle al Cliente","Customer's signature":"Firma del cliente",Customers:"Clientes",Date:"Fecha","Date of service start":"Fecha de inicio del servicio","Delete customer":"eliminar cliente","Delete service report":"Eliminar informe de servicio","Delete user":"eliminar el usuario","Downloading an update":"Descarga de una actualizaciÃÂÃÂ³n",Duration:"duraciÃÂÃÂ³n","Duration of service":"DuraciÃÂÃÂ³n del servicio","Edit customer":"Editar cliente","Edit service report":"Editar informe de servicio","Edit user":"Editar usuario",Email:"Email","Email address":"direcciÃÂÃÂ³n de correo electrÃÂÃÂ³nico","Email address is not valid":"DirecciÃÂÃÂ³n de correo electrÃÂÃÂ³nico no es vÃÂÃÂ¡lida","Email address of the user":"DirecciÃÂÃÂ³n de correo electrÃÂÃÂ³nico del usuario","Email of the user":"Correo electrÃÂÃÂ³nico del usuario",Fax:"Fax","Filter customers":"Filtrar los clientes","Filter service reports":"Informes de los servicios de filtro","Filter users":"usuarios filtro","Hello dogs !":"Hola perros !",Home:"Inicio",Id:"Id","It allows the management of customers, orders and service reports.":"Permite la gestiÃÂÃÂ³n de clientes, pedidos e informes de servicio .",Location:"UbicaciÃÂÃÂ³n","Location of service":"UbicaciÃÂÃÂ³n del servicio","Log in":"iniciar sesiÃÂÃÂ³n","Log out":"salir",N:"N",Name:"Nombre","Name of the user":"Nombre de usuario","New customer":"Nuevo cliente","New report":"Nuevo informe","New user":"Nuevo usuario","No update is present":"Ninguna actualizaciÃÂÃÂ³n estÃÂÃÂ¡ presente",Notes:"Notas",Number:"NÃÂÃÂºmero",Operator:"operador","Operator of service":"Operador de servicio","Operator's signature":"Firma del",Orders:"ÃÂÃÂ³rdenes","P.IVA":"P.IVA","P.IVA contains invalid character(s)":"P.IVA contiene caracteres no vÃÂÃÂ¡lidos ( s )","P.IVA control code doesn't match":"CÃÂÃÂ³digo de control P.IVA no coincide",Phone:"TelÃÂÃÂ©fono","Phone number":"nÃÂÃÂºmero de telÃÂÃÂ©fono","Phone number is not valid":"NÃÂÃÂºmero de telÃÂÃÂ©fono no es vÃÂÃÂ¡lido",Place:"lugar","Preparing the downloading an update":"PreparaciÃÂÃÂ³n de la descarga de una actualizaciÃÂÃÂ³n",Print:"Imprimir","Print customer":"Imprimir cliente","Print service report":"Imprimir informe de servicio","Print user":"usuario Imprimir",Provider:"Proveedor",Register:"Registro",Roles:"Roles",Save:"Guardar","Service report":"informe del Servicio de","Service report n":"Informe del Servicio de n","Service reports":"informes de servicio",Setup:"ConfiguraciÃÂÃÂ³n","Street address":"direcciÃÂÃÂ³n","This customer name is already in use":"Este nombre del cliente ya estÃÂÃÂ¡ en uso","This customer name is not valid":"Este nombre del cliente no es vÃÂÃÂ¡lida","This is":"esto es","This user can nor read nor write":"Este usuario puede ni leer ni escribir","This user can read":"Este usuario puede leer","This user can read and write":"Este usuario puede leer y escribir","This user can write":"Este usuario puede escribir","This user can't access":"Este usuario no tiene acceso","This user name is already in use":"Este nombre de usuario ya estÃÂÃÂ¡ en uso","This user name is not valid":"Este nombre de usuario no es vÃÂÃÂ¡lida","This value is nor a Codice Fiscale nor a P.IVA":"Este valor es ni un cÃÂÃÂ³digo fiscal ni un P.IVA","Time of service start":"Hora de inicio del servicio","Toggle navigation":"navegaciÃÂÃÂ³n toggle","User email address":"DirecciÃÂÃÂ³n de correo electrÃÂÃÂ³nico del usuario","User name":"nombre de usuario",Username:"Nombre de usuario",Users:"Usuarios","You are offline":"Usted estÃÂÃÂ¡ fuera de lÃÂÃÂ­nea","You are online":"Usted estÃÂÃÂ¡ en lÃÂÃÂ­nea",cached:"cachÃÂÃÂ©",cancel:"cancelar",checking:"comprobaciÃÂÃÂ³n",customers:"clientes",downloading:"descarga",error:"error","home page for non registered users.":"pÃÂÃÂ¡gina de inicio para usuarios no registrados.","home page for registerd users.":"pÃÂÃÂ¡gina de inicio para los usuarios registerd .",initializing:"inicializar","is a web application for (smart) start-ups.":"es una aplicaciÃÂÃÂ³n web para ( inteligentes) de nueva creaciÃÂÃÂ³n.","logged user":"usuario conectado",obsolete:"obsoleto",orders:"ÃÂÃÂ³rdenes","otherwise register a new accout and log in.":"de lo contrario registrar un nuevo accout e ingrese .","password:":"contraseÃÂÃÂ±a:",progress:"progreso",servicereports:"servicereports",updateready:"updateready","username:":"nombre de usuario :",users:"usuarios","Hello babe":"Hola nena"}),a.setStrings("fr",{"(hh:mm)":"(hh:mm)","A Codice Fiscale or a P.IVA is required":"Un Codice Fiscale ou un P.IVA est nÃÂÃÂ©cessaire","A customer name is required":"Un nom de client est tenu","A date of service start is required":"Une date de dÃÂÃÂ©marrage du service est nÃÂÃÂ©cessaire","A location of service is required":"Un emplacement de service est nÃÂÃÂ©cessaire","A phone number is required":"Un numÃÂÃÂ©ro de tÃÂÃÂ©lÃÂÃÂ©phone est nÃÂÃÂ©cessaire","A street address is required":"Une adresse municipale est requise","A user name is required":"Un nom d'utilisateur est nÃÂÃÂ©cessaire",About:"Sur","Add new customer":"Ajouter un nouveau client","Add new user":"Ajouter un nouvel utilisateur",Address:"Adresse","An email address is required":"Une adresse e-mail est requise","An operator is required":"Un exploitant est tenu","An update is available: do you want to load it now?":"Une mise ÃÂÃÂ  jour est disponible: voulez-vous charger maintenant?","An update is ready":"Une mise ÃÂÃÂ  jour est prÃÂÃÂªte","Are you really sure to remove service report":"ÃÂÃÂtes-vous vraiment sÃÂÃÂ»r d'enlever rapport de service","Are you really sure to remove user":"ÃÂÃÂtes-vous vraiment sÃÂÃÂ»r de supprimer l'utilisateur","Authentication id":"Id d'authentification","Authentication id of the user":"Id d'authentification de l'utilisateur","Authentication id:":"Authentification id:","Authentication provider":"Le fournisseur d'authentification","Authentication provider for the user":"Le fournisseur d'authentification pour l'utilisateur",Avatar:"Avatar","Avatar image of the user":"Image Avatar de l'utilisateur","C.F./P.IVA":"C.F./P.IVA","Cache is being initialized":"Cache est en cours d'initialisation","Cache is in unknown state":"Cache est dans un ÃÂÃÂ©tat inconnu","Cache is not updated (probably the manifest is unreachable)":"Cache n'est pas mis à jour ( probablement le manifeste est inaccessible )","Cache is not updated because you are offline":"Cache n'est pas mis à jour parce que vous êtes en mode hors connexion","Cache is obsolete":"Cache est obsolÃÂÃÂ¨te","Cache is up-to-date":"Le cache est mis ÃÂÃÂ  jour","Cache status is":"Statut de cache est","Checking for the presence of an update":"VÃÂÃÂ©rification de la prÃÂÃÂ©sence d' une mise ÃÂÃÂ  jour","Codice Fiscale / P.IVA":"Codice Fiscale / P.IVA","Codice Fiscale contains invalid character(s)":"Codice Fiscale contient caractÃÂÃÂ¨re(s) non valide","Codice Fiscale control code doesn't match":"Code de contrÃÂÃÂ´le Codice Fiscale ne correspond pas","Codice Fiscale or P.IVA of the customer":"Codice Fiscale ou P.IVA du client","Company logo":"Logo de l'entreprise","Connect with Facebook":"Connectez-vous avec Facebook","Connect with Google+":"Connectez-vous avec Google+","Connect with Twitter":"Connectez-vous avec Twitter",Contacts:"Contacts","Current language is":"La langue actuelle est",Customer:"Client","Customer Card":"Carte de fidÃÂÃÂ©litÃÂÃÂ©","Customer email address":"Client adresse e-mail","Customer name":"Nom du client","Customer phone number":"Le numÃÂÃÂ©ro de tÃÂÃÂ©lÃÂÃÂ©phone du client","Customer street address":"Adresse de la rue ÃÂÃÂ  la clientÃÂÃÂ¨le","Customer's signature":"Signature du client",Customers:"ClientÃÂÃÂ¨le",Date:"Date","Date of service start":"Date de dÃÂÃÂ©marrage du service","Delete customer":"Supprimer la clientÃÂÃÂ¨le","Delete service report":"Supprimer rapport de service","Delete user":"Supprimer un utilisateur","Downloading an update":"TÃÂÃÂ©lÃÂÃÂ©chargement d'une mise ÃÂÃÂ  jour",Duration:"DurÃÂÃÂ©e","Duration of service":"DurÃÂÃÂ©e du service","Edit customer":"Modifier la clientÃÂÃÂ¨le","Edit service report":"Modifier rapport de service","Edit user":"Modifier l'utilisateur",Email:"Email","Email address":"Adresse e-mail","Email address is not valid":"Adresse e-mail n'est pas valide","Email address of the user":"Adresse e-mail de l'utilisateur","Email of the user":"Email de l'utilisateur",Fax:"Fax","Filter customers":"Clients de filtrage","Filter service reports":"Rapports de services de filtrage","Filter users":"Utilisateurs de filtrage","Hello dogs !":"Bonjour les chiens !",Home:"Maison",Id:"Id","It allows the management of customers, orders and service reports.":"Il permet la gestion des clients , des commandes et des rapports de service .",Location:"Emplacement","Location of service":"Lieu du service","Log in":"S'identifier","Log out":"DÃÂÃÂ©connexion",N:"N",Name:"Nom","Name of the user":"Nom de l'utilisateur","New customer":"Nouveau client","New report":"Nouveau rapport","New user":"Nouvel utilisateur","No update is present":"Aucune mise ÃÂÃÂ  jour est prÃÂÃÂ©sente",Notes:"Remarques",Number:"Nombre",Operator:"OpÃÂÃÂ©rateur","Operator of service":"OpÃÂÃÂ©rateur de services","Operator's signature":"La signature de l'opÃÂÃÂ©rateur",Orders:"Ordres","P.IVA":"P.IVA","P.IVA contains invalid character(s)":"P.IVA contient caractÃÂÃÂ¨re(s) non valide","P.IVA control code doesn't match":"Code de commande de P. IVA ne correspond pas",Phone:"TÃÂÃÂ©lÃÂÃÂ©phone","Phone number":"NumÃÂÃÂ©ro de tÃÂÃÂ©lÃÂÃÂ©phone","Phone number is not valid":"NumÃÂÃÂ©ro de tÃÂÃÂ©lÃÂÃÂ©phone n'est pas valide",Place:"Lieu","Preparing the downloading an update":"PrÃÂÃÂ©paration du tÃÂÃÂ©lÃÂÃÂ©chargement d'une mise ÃÂÃÂ  jour",Print:"Imprimer","Print customer":"Imprimer client","Print service report":"Imprimer le rapport de service","Print user":"Imprimer utilisateur",Provider:"Fournisseur",Register:"S'inscrire",Roles:"RÃÂÃÂ´les",Save:"Enregistrer","Service report":"Rapport du service","Service report n":"Rapport de service n","Service reports":"Rapports de service",Setup:"Installation","Street address":"Rue","This customer name is already in use":"Ce nom de client est dÃÂÃÂ©jÃÂÃÂ  en cours d'utilisation","This customer name is not valid":"Ce nom de client n'est pas valide","This is":"C'est","This user can nor read nor write":"Cet utilisateur peut ni lire ni ÃÂÃÂ©crire","This user can read":"Cet utilisateur peut lire","This user can read and write":"Cet utilisateur peut lire et ÃÂÃÂ©crire","This user can write":"Cet utilisateur peut ÃÂÃÂ©crire","This user can't access":"Cet utilisateur ne peut pas accÃÂÃÂ©der","This user name is already in use":"Ce nom d'utilisateur est dÃÂÃÂ©jÃÂÃÂ  utilisÃÂÃÂ©","This user name is not valid":"Ce nom d'utilisateur n'est pas valide","This value is nor a Codice Fiscale nor a P.IVA":"Cette valeur est ni une Fiscale Codice ni P.IVA","Time of service start":"Temps de dÃÂÃÂ©marrage du service","Toggle navigation":"navigation bascule","User email address":"Utilisateur adresse e-mail","User name":"Nom d'utilisateur",Username:"Nom d'utilisateur",Users:"Utilisateurs","You are offline":"Vous n'ÃÂÃÂªtes pas connectÃÂÃÂ©","You are online":"Vous ÃÂÃÂªtes en ligne",cached:"cache",cancel:"annuler",checking:"vÃÂÃÂ©rification",customers:"clientÃÂÃÂ¨le",downloading:"tÃÂÃÂ©lÃÂÃÂ©chargement",error:"erreur","home page for non registered users.":"page d'accueil pour les utilisateurs non enregistrÃÂÃÂ©s.","home page for registerd users.":"page d'accueil pour les utilisateurs registerd.",initializing:"initialiser","is a web application for (smart) start-ups.":"est une application web pour (smart) start-ups.","logged user":"utilisateur connectÃÂÃÂ©",obsolete:"obsolÃÂÃÂ¨te",orders:"ordres","otherwise register a new accout and log in.":"sinon enregistrer une nouvelle accout et connectez-vous.","password:":"mot de passe:",progress:"progrÃÂÃÂ¨s",servicereports:"servicereports",updateready:"updateready","username:":"nom d'utilisateur:",users:"utilisateurs","Hello babe":"Bonjour bÃÂ©bÃÂ©"}),a.setStrings("it",{"(hh:mm)":"(hh:mm)","A Codice Fiscale or a P.IVA is required":"Un Codice Fiscale o una P.IVA è richiesto","A customer name is required":"Un nome cliente è richiesto","A date of service start is required":"Una data di inizio del servizio è richiesta","A duration must be in the form 'hh' or 'hh:mm', and at least one minute long":"Una durata deve essere nella forma 'hh' oppure 'hh:mm', ed almeno di un minuto","A location of service is required":"Un luogo del servizio è richiesto","A phone number is required":"Un numero di telefono è richiesto","A street address is required":"Un indirizzo stradale è richiesto","A user name is required":"Un nome utente è richiesto",About:"Info","Add new customer":"Aggiungi nuovo cliente","Add new user":"Aggiungi nuovo cliente",Address:"Indirizzo stradale","An email address is required":"Un indirizzo email è richiesto","An operator is required":"Un operatore è richiesto","An update is available: do you want to load it now?":"E' disponibile un aggiornamento: lo si vuole caricare adesso?","An update is ready":"E' disponibile un aggiornamento","Are you really sure to remove service report":"Sei veramente sicuro di rimuovere il rapporto di servizio","Are you really sure to remove user":"Sei veramente sicuro di rimuovere l'utente","Authentication id":"Id di autenticazione","Authentication id of the user":"Id di autenticazione dell'utente","Authentication id:":"Id di autenticazione:","Authentication provider":"Fornitore di autenticazione","Authentication provider for the user":"Fornitore di autenticazione per l'utente",Avatar:"Avatar","Avatar image of the user":"Immagine avatar dell'utente","C.F./P.IVA":"C.F./P.IVA","Cache is being initialized":"La cache è inizializzata","Cache is in unknown state":"La cache è in uno stato non previsto","Cache is not updated (probably the manifest is unreachable)":"La cache non è aggiornata (probabilmente il manifesto è irraggiungibile)","Cache is not updated because you are offline":"La cache non è aggiornata perché si è offline","Cache is obsolete":"La cache è obsoleta","Cache is up-to-date":"La cache è aggiornata","Cache status is":"Lo stato della cache è","Checking for the presence of an update":"Si controlla la presenza di un aggiornamento","Codice Fiscale / P.IVA":"Codice Fiscale / P.IVA","Codice Fiscale contains invalid character(s)":"Codice Fiscale contiene caratteri non validi","Codice Fiscale control code doesn't match":"Il codice di controllo del Codice Fiscale non corrisponde","Codice Fiscale or P.IVA of the customer":"Codice Fiscale o P.IVA del cliente","Company logo":"Logo aziendale","Connect with Facebook":"Accedi con Facebook","Connect with Google+":"Accedi con Google+","Connect with Twitter":"Accedi con Twitter",Contacts:"Contatti","Current language is":"La lingua attuale è",Customer:"Cliente","Customer Card":"Scheda del cliente","Customer email address":"Indirizzo email del cliente","Customer name":"Nome del cliente","Customer phone number":"Numero di telefono del cliente","Customer street address":"Indirizzo stradale del cliente","Customer's signature":"Firma del cliente",Customers:"Clienti",Date:"Data","Date of service start":"Data di inizio del servizio","Delete customer":"Rimuovi cliente","Delete service report":"Rimuovi il rapporto di servizio","Delete user":"Rimuovi utente","Downloading an update":"Si scarica un aggiornamento",Duration:"Durata","Duration of service":"Durata del servizio","Edit customer":"Modifica il cliente","Edit service report":"Modifica il rapporto di servizio","Edit user":"Modifica l'utente",Email:"Email","Email address":"Indirizzo email","Email address is not valid":"L'indirizzo email non è valido","Email address of the user":"Indirizzo email dell'utente","Email of the user":"Indirizzo email dell'utente",'Enter using one of your "social" accounts, or log in with these credentials:':'Accedere utilizzando un proprio account "social", oppure accedere con queste credenziali:',Fax:"Fax","Filter customers":"Filtra i clienti","Filter service reports":"Filtra i rapporti di servizio","Filter users":"Filtra gli utenti",Home:"Home",Id:"Id","It allows the management of customers, orders and service reports.":"Consente la gestione di clienti, ordini e rapporti di servizio.","It is open-source, fast, compact, extensible, resilient, international and mobile.":"E' open-source, veloce, compatta, estendibile, resiliente, internazionale e mobile.",Location:"Luogo","Location of service":"Luogo del servizio","Log in":"Accedi","Log out":"Esci",N:"N",Name:"Nome","Name of the user":"Nome dell'utente","New customer":"Nuovo cliente","New report":"Nuovo rapporto","New user":"Nuovo utente","No update is present":"Nessun aggiornamento presente",Notes:"Note",Number:"Numero",Operator:"Operatore","Operator of service":"Operatore del servizio","Operator's signature":"Firma dell'operatore",Orders:"Ordini","P.IVA":"P.IVA","P.IVA contains invalid character(s)":"P.IVA contiene caratteri non validi","P.IVA control code doesn't match":"Il codice di controllo della P.IVA non corrisponde",Phone:"Telefono","Phone number":"Numero di telefono","Phone number is not valid":"Il numero di telefono non è valido",Place:"Luogo","Preparing the downloading an update":"Si prepara lo scarico di un aggiornamento",Print:"Stampa","Print customer":"Stampa il cliente","Print service report":"Stampa rapporto di servizio","Print user":"Stampa l'utente",Provider:"Fornitore",Register:"Registrati",Roles:"Ruoli","Roles for this user; click to slide through all states (RW -> R -> W -> none)":"Ruoli per questo utente; clicca per scorrere tutti gli stati (RW -> R -> W -> nessuno)","Roles of the user: green color indicates permission for read and write, yellow means only read, blue only write, and read no permission. Sections are: 'u' (users), 'c' (customers), 'o' (orders), 's' (service reports).":"I ruoli dell'utente: il colore verde indica il permesso di lettura e scrittura, il giallo significa sola lettura, il blu solo scrittura, ed il rosso nessun permesso. Le sezioni sono: 'u' (utenti), 'c' (clienti), 'o' (ordini), 's' (rapporti di servizio).",Save:"Salva","Service report":"Rapporto di servizio","Service report n":"Rapporto di servizio  n","Service reports":"Rapporti di servizio",Setup:"Impostazioni","Street address":"Indirizzo stradale","This customer name is already in use":"Questo nome cliente è già in uso","This customer name is not valid":"Il nome del cliente non è valido","This is":"Questa è","This user can nor read nor write":"Questo utente non può né leggere né scrivere","This user can read":"Questo utente può leggere","This user can read and write":"Questo utente può leggere e scrivere","This user can write":"Questo utente può scrivere","This user can't access":"Questo utente non può accedere a","This user name is already in use":"Questo nome utente è già in uso","This user name is not valid":"Questo nome utente non è valido","This value is nor a Codice Fiscale nor a P.IVA":"Questo valore non è né un Codice Fiscale né una P.IVA","Time of service start":"Orario di inizio del servizio","Toggle navigation":"Cambia navigazione","User email address":"Indirizzo email","User name":"Nome utente",Username:"Nome utente",Users:"Utenti","You are offline":"Si è offline","You are online":"Si è online",cached:"aggiornato",cancel:"annulla",checking:"in fase di controllo",customers:"clienti",downloading:"in fase di scarico",error:"errore","home page for non registered users.":"home page di per gli utenti non registrati.","home page for registerd users.":"home page di per gli utenti registrati.",initializing:"in fase di inizializzazione","is a web application for (smart) start-ups.":"è un'applicazione per (smart) start-ups.","logged user":"utente connesso",obsolete:"obsoleta",orders:"ordini","otherwise register a new accout and log in.":"altrimenti registrare un nuovo account ed accedere.","password:":"password:",progress:"in corso",servicereports:"rapporti di servizio",updateready:"aggiornamento disponibile","username:":"utente:",users:"utenti","<em>smartUp</em> is a web application for (smart) start-ups.<br>\n      It allows the management of customers, orders and service reports.<br>\n      It is open-source, fast, compact, extensible, resilient, international and mobile.<br>":"<em>smartUp</em> è un'applicazione web per (smart) start-ups.<br>\n       Consente la gestione di clienti, ordini e rapporti di servizio.<br>\n       E' open-source, veloce, compatta, estensibile, resiliente, internazionale e mobile.<br>","This user name is already present":"Questo nome utente è già presente","User name is not valid":"Il nome utente non è valido","User street address":"Indirizzo stradale dell'utente","Avatar image of user":"Immagine avatar dell'utente","User email":"Indirzzo email dell'utente",read:"leggere",write:"scrivere","P.&nbsp;IVA":"P.&nbsp;IVA","Service report n&#176;":"Rapporto di servizio  n&#176;","Customer name must be valid":"Il nome del cliente deve essere valido","Not yet available...":"Non ancora disponibile...","N&deg;":"N&deg;","Date of service begin":"Data di inizio del servizio"})
}]),app.controller("HomeCtrl",["$rootScope",function(a){a.formLabel=""}]),app.controller("AuthCtrl",["$scope","$rootScope","$routeParams","$location","$window","CFG","I18N","gettext","gettextCatalog","Auth","User",function(a,b,c,d,e,f,g,h,i,j,k){b.formLabel="",a.params=c,a.error=null,a.info=null,a.debug=f.DEBUG,a.lastBuildDate=lastBuildDate,a.$watch(function(){return b.online},function(){a.online=b.online},!0),f.APPCACHE&&(a.$watch(function(){return b.appcache},function(){a.appcache=b.appcache},!0),a.appcacheStatus=function(){var c;switch(b.appcache.status){case"initializing":c=h("Cache is being initialized");break;case"error":c=h(a.online?"Cache is not updated (probably the manifest is unreachable)":"Cache is not updated because you are offline");break;case"cached":c=h("Cache is up-to-date");break;case"checking":c=h("Checking for the presence of an update");break;case"downloading":c=h("Preparing the downloading an update");break;case"noupdate":c=h("No update is present");break;case"obsolete":c=h("Cache is obsolete");break;case"progress":c=h("Downloading an update");break;case"updateready":c=h("An update is ready"),e.applicationCache.swapCache(),e.location.reload(),b.appcache.status="initializing";break;default:c=h("Cache is in unknown state")+' "'+b.appcache.status+'"'}toastr.info(i.getString(c))}),a.register=function(b){return console.info("controller - register"),a.$broadcast("autofillFix:update"),a.formRegisterSubmitted=!0,b?(console.info("controller - register - valid",a.user),void(a.user?j.register(a.user).then(function(b){console.info("registered user:",b.user),b.user.username=a.user.username,k.create(b.user,a.user.password).then(function(){d.path("/")},function(a){toastr.error("Couldn't create user "+b.user.username),console.error("Couldn't create user ",b.user,":",a)})},function(b){if("FirebaseSimpleLogin: The specified email address is already in use."===b.message){var c=k.findByUsername("_"+a.user.username);console.log("looked up user:",c),c.email.toLowerCase()===a.user.email.toLowerCase()&&c.deleted&&(toastr.error("This account was deleted. Just log-in and it will be restored..."),console.info("deleted account"))}else a.error="Sorry, could not register user ("+b.message+")",console.error("Register error:",b.message)}):a.error="Please specify user's data")):void console.error("not valid",b)},a.login=function(){a.$broadcast("autofillFix:update"),a.user&&a.user.usernameOrEmail&&a.user.password?j.login(a.user).then(function(b){if(console.warn("Auth.login($scope.user).then() RETURNED - authUser:",b),b){var c=k.find(b.uid);k.setCurrentUser(c),k.undelete(c),d.path("/")}else a.error="Please specify an existing username/email"},function(b){console.warn("Auth.login($scope.user).then() RETURNED ERROR. user was",a.user),a.error="Login failed ("+b.message+")"}):a.user?a.user.usernameOrEmail?a.user.password||(a.error="Please specify a password"):a.error="Please specify a username/email":a.error="Please specify a username/email and password"},a.loginSocial=function(a){j.loginSocial(a).then(function(a){k.create(a).then(function(){var b=k.find(a.uid);k.setCurrentUser(b)},function(b){toastr.error("Couldn't create user "+a.username),console.error("Couldn't create user "+a+":",b)})},function(b){console.error="loginSocial("+a+") failed ("+b.message+")",toastr.error="loginSocial("+a+") failed ("+b.message+")"})},a.logout=function(){k.resetCurrentUser(),j.logout(),b.formLabel="",d.path("/")},a.sendPasswordResetEmail=function(b){a.reset(),j.sendPasswordResetEmail(b).then(function(b){"undefined"==typeof b?(toastr.info("Password sent"),a.info="An email with a temporary password has been sent to your email: use it to login and then change it."):a.error="INVALID_EMAIL"===b.code?"Please specify a valid email":"INVALID_USER"===b.code?"Sorry, this is not a registered email":"Sorry, could not send password email ("+b.message+"). Please retry later."})},a.reset=function(){a.error=null,a.info=null},a.getCurrentLanguage=function(){return g.getCurrentLanguage()},a.getCurrentLanguageName=function(){return g.getCurrentLanguageName()},a.getCurrentLanguageFlag=function(){return g.getCurrentLanguageFlag()},a.getCurrentLanguageScript=function(){return g.getCurrentLanguageScript()},a.setNextLanguage=function(){return g.setNextLanguage()},a.reset()}]),app.controller("OrdersCtrl",["$scope","$location","Order",function(a,b,c){"/orders"===b.path()&&(a.orders=c.all);var d=new Date;a.orderPlaceholder={url:"http://",title:""},a.orderPlaceholder={customer:"",title:"",date:d,delivery:""},a.order=a.orderPlaceholder,a.submitOrder=function(){c.create(a.order).then(function(c){a.order=a.orderPlaceholder,b.path("/orders/"+c)})},a.deleteOrder=function(a){c.delete(a)}}]),app.controller("CustomersCtrl",["$scope","$rootScope","$location","CFG","Customer",function(a,b,c,d,e){b.formLabel="Customers",a.customer={},a.customers=e.all,a.CFG=d,a.$watch("formAddEdit.$valid",function(b){console.info("form addedit validity is",b),a.formAddEditValid=b}),a.initCustomer=function(){a.customer.name=null,a.customer.cfpiva=null,a.customer.address=null,a.customer.phone=null,a.customer.email=null,a.customer.dateCreation=null,a.formAddEditValid=!1,a.formAddEditSubmitted=!1,a.addMode=!1,a.editMode=!1,a.printMode=!1,a.orderby="name",a.autocompleteAddressResult="",a.autocompleteAddressOptions=null,a.autocompleteAddressDetails={types:"establishments"}},a.submitCustomer=function(){console.info("sumbit customer"),a.formAddEditSubmitted=!0,a.formAddEditValid&&(a.editMode&&(a.customer.lastModify=new Date,e.set(a.customer.$id,a.customer).then(function(){})),a.addMode&&(a.customer.dateCreation=new Date,e.create(a.customer).then(function(){})),a.addMode=a.editMode=!1,a.formAddEditSubmitted=!1)},a.cancelCustomer=function(){a.initCustomer(),console.log("CANCEL - customer now is empty:",a.customer)},a.deleteCustomer=function(a){console.info("deleteCustomer:",a),e.delete(a).then(function(a){a?(console.info("deleteCustomer - error",a.replace(/_/," ")),toastr.error("Customer not deleted: "+a.replace(/_/," "))):(console.info("deleteCustomer - success"),toastr.info("Customer deleted"))})},a.addCustomer=function(){a.initCustomer(),a.addMode=!0},a.currentUserCanRead=function(){return b.currentUser&&b.currentUser.roles&&b.currentUser.roles.customers?b.currentUser.roles.customers.read:!1},a.currentUserCanWrite=function(){return b.currentUser&&b.currentUser.roles&&b.currentUser.roles.customers?b.currentUser.roles.customers.write:!1},a.editCustomer=function(b){if(console.log("EDITCUSTOMER",b),a.editMode)a.editMode=!1;else{var c=b.$id;a.customer=e.find(c),a.editMode=!0}},a.preprintCustomer=function(b){var c=b.$id;a.printMode?a.printMode=!1:(a.customer=e.find(c),console.info("Preprint $scope.customer:",c,a.customer),a.printMode=!0)},a.printCustomer=function(){a.printMode&&(a.print(),window.onafterprint=function(){console.log("Printing dialog closed..."),a.printMode=!1,a.$apply()})},a.print=function(){setTimeout(function(){window.print()},0)},a.initCustomer()}]),app.controller("ServicereportsCtrl",["$scope","$rootScope","$location","CFG","Servicereport","Customer","Auth","DateTime",function(a,b,c,d,e,f,g,h){b.formLabel="Service reports",a.servicereport={},a.servicereports=e.all,a.CFG=d,a.customersById={},a.customers=f.all,a.customers.$on("loaded",function(){angular.forEach(a.customers,function(b,c){"object"==typeof b&&(a.customersById[c]=b)})}),a.$watch(g.currentUser,function(b){b&&(a.servicereport.operator=a.currentUser.username)},!0),a.$watch("formAddEdit.$valid",function(){a.formAddEditValid=!0}),a.servicereports.$on("loaded",function(){a.servicereport.number=e.getNumberNext()}),a.initServicereport=function(){a.servicereport.operator=a.currentUser?a.currentUser.username:null,a.servicereport.dateIn=new Date,a.servicereport.dateOut=a.servicereport.dateIn,a.servicereport.duration=null,a.servicereport.location=null,a.servicereport.notes=null,a.servicereport.dateCreation=null,a.customer=null,a.formAddEditValid=!1,a.formAddEditSubmitted=!1,a.currentId=null,a.addMode=!1,a.editMode=!1,a.printMode=!1,a.orderby="-number",a.dateInit()},a.submitServicereport=function(){a.formAddEditSubmitted=!0,a.formAddEditValid&&(a.servicereport.customerId=a.customer.$id,a.servicereport.dateCreation=new Date,a.setDateOut(),a.editMode&&e.set(a.currentId,a.servicereport).then(function(){}),a.addMode&&e.create(a.servicereport).then(function(){}),a.addMode=a.editMode=!1,a.formAddEditSubmitted=!1)},a.cancelServicereport=function(){a.addMode&&(a.servicereport.number=e.resetNumberNext()),a.initServicereport()},a.deleteServicereport=function(a){e.delete(a)},a.addServicereport=function(){a.initServicereport(),a.addMode=!0,a.servicereport.number=e.setNumberNext()},a.currentUserCanRead=function(){return b.currentUser&&b.currentUser.roles&&b.currentUser.roles.servicereports?b.currentUser.roles.servicereports.read:!1},a.currentUserCanWrite=function(){return b.currentUser&&b.currentUser.roles&&b.currentUser.roles.servicereports?b.currentUser.roles.servicereports.write:!1},a.editServicereport=function(b){if(a.editMode)a.editMode=!1;else{var c=b.$id;a.currentId=c,a.servicereport=e.find(c),a.customer=f.find(a.servicereport.customerId),a.editMode=!0}},a.preprintServicereport=function(b){var c=b.$id;a.printMode?a.printMode=!1:(a.currentId=c,a.servicereport=e.find(c),a.customer=f.find(a.servicereport.customerId),a.printMode=!0)},a.printServicereport=function(){a.printMode&&(a.print(),window.onafterprint=function(){a.printMode=!1,a.$apply()})},a.dateInit=function(){a.dateMin=null,a.dateMax=null,a.dateFormat="longDate",a.dateOptions={formatYear:"yyyy",startingDay:1,showWeeks:!1},a.hourStep=1,a.minuteStep=1,a.showMeridian=!1,a.servicereport.dateIn=new Date,a.servicereport.dateOut=a.servicereport.dateIn,a.timeIn=a.servicereport.dateIn,a.servicereport.dateIn.setHours(a.timeIn.getHours()),a.servicereport.dateIn.setMinutes(a.timeIn.getMinutes()),a.servicereport.dateIn.setSeconds(0),a.dateDisabled=function(){return!1},a.dateOpen=function(b){b.preventDefault(),b.stopPropagation(),a.dateOpened=!0},a.timeChanged=function(){console.info("dateIn without time set:",a.servicereport.dateIn),console.info("timeChanged:",a.timeIn.getHours(),a.timeIn.getMinutes()),a.servicereport.dateIn.setHours(a.timeIn.getHours()),a.servicereport.dateIn.setMinutes(a.timeIn.getMinutes()),a.servicereport.dateIn.setSeconds(0),console.info("dateIn with time set:",a.servicereport.dateIn)}},a.setDateOut=function(){var b=new h(a.servicereport.dateOut),c=a.servicereport.duration.split(":");b.addHours(c[0]||0),b.addMinutes(c[1]||0),a.servicereport.dateOut=b.get()},a.getCustomers=function(a){return console.info("getCustomers() - viewValue:",a),f.all},a.onCustomerSelect=function(b,c,d){console.info("onCustomerSelect() - item, model, label:",b,c,d),console.info("item:",b),a.customer=b,a.servicereport.location=b.address},a.print=function(){setTimeout(function(){window.print()},0)},a.initServicereport()}]),app.controller("ContactsCtrl",["$rootScope",function(a){a.formLabel="Contacts"}]),app.controller("AboutCtrl",["$rootScope",function(a){a.formLabel="About"}]),app.controller("OrderViewCtrl",["$scope","$routeParams","Order",function(a,b,c){a.order=c.find(b.orderId),a.addItem=function(){c.addItem(b.orderId,a.item),a.item=""},a.deleteItem=function(b,d){c.deleteItem(a.order,b,d)}}]),app.controller("UsersCtrl",["$scope","$rootScope","$routeParams","$location","CFG","User","Auth","gettext",function(a,b,c,d,e,f,g,h){b.formLabel="Users",a.roles=[{key:"u",desc:h("users")},{key:"c",desc:h("customers")},{key:"o",desc:h("orders")},{key:"s",desc:h("servicereports")}],a.user=c.username?f.findByUsername(c.username):{},a.users=f.all,console.info("users: ",a.users),a.CFG=e,a.$watch("formAddEdit.$valid",function(b){console.info("form edit validity is",b),a.formAddEditValid=b}),a.initUser=function(){a.user.username=null,a.user.dateCreation=null,a.formAddEditValid=!1,a.formAddEditSubmitted=!1,a.editMode=!1,a.printMode=!1,a.orderby="name"},a.editUser=function(b){console.log("EDITUSER",b),a.editMode?a.editMode=!1:(a.user=f.find(b.uid),a.editMode=!0,console.info("editing user:",a.user))},a.submitUser=function(){console.info("sumbit User, form is valid?",a.formAddEditValid),a.formAddEditSubmitted=!0,a.formAddEditValid&&(a.editMode&&(a.user.lastModify=new Date,console.info("sumbit User in edit mode:",a.user),f.set(a.user.uid,a.user).then(function(){})),a.editMode=!1,a.formAddEditSubmitted=!1)},a.cancelUser=function(){a.initUser(),console.log("CANCEL - user now is empty:",a.user)},a.deleteUser=function(a){console.info("deleteUser:",a),f.delete(a).then(function(a){a?(console.info("deleteUser - error",a.replace(/_/," ")),toastr.error("User not deleted: "+a.replace(/_/," "))):(console.info("deleteUser - success"),toastr.info("User deleted"))})},a.addUser=function(){d.path("/register")},a.currentUserCanRead=function(){return b.currentUser&&b.currentUser.roles&&b.currentUser.roles.users?b.currentUser.roles.users.read:!1},a.currentUserCanWrite=function(){return b.currentUser&&b.currentUser.roles&&b.currentUser.roles.users?b.currentUser.roles.users.write:!1},a.flipRole=function(a,b){if(!a.roles||!a.roles[b])return console.error("user:",a,"no such roledesc:",b),!1;var c=a.roles[b];return c.read&&c.write?(a.roles[b].read=!0,a.roles[b].write=!1):c.read&&!c.write?(a.roles[b].read=!1,a.roles[b].write=!0):!c.read&&c.write?(a.roles[b].read=!1,a.roles[b].write=!1):(a.roles[b].read=!0,a.roles[b].write=!0),!0},a.userRoleDescription=function(a,b){if(a.roles&&a.roles[b]){var c=a.roles[b];return h(c.read&&c.write?"This user can read and write":c.read&&!c.write?"This user can read":!c.read&&c.write?"This user can write":"This user can nor read nor write")}return h("This user can't access")}}]),app.controller("ModalInstanceCtrl",["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}]),app.factory("Auth",["$rootScope","$firebase","$firebaseSimpleLogin","$q","CFG","User",function(a,b,c,d,e,f){var g=new Firebase(e.FIREBASE_URL),h=c(g),i={register:function(a){return h.$createUser(a.email,a.password)},signedIn:function(){return null!==h.user&&a.currentUser?!0:void 0},hasRole:function(b){if(null!==h.user&&a.currentUser&&a.currentUser.roles){if(b&e.ROLES.ADMIN&&a.currentUser.roles.admin)return!0;if(b&e.ROLES.EDIT_CUSTOMERS&&a.currentUser.roles.editCustomers)return!0}return!1},currentUser:function(){return null!==h.user?a.currentUser:void 0},login:function(a){if(a.usernameOrEmail&&-1!==a.usernameOrEmail.indexOf("@"))a.email=a.usernameOrEmail;else{var b=f.findByUsername(a.usernameOrEmail);if(b&&b.email)a.email=b.email;else{var c=f.findByUsername("_"+a.usernameOrEmail);if(!c||!c.email){console.warn("return defer error, existingUser undefined or without email:",b);var g=d.defer();return g.resolve(null),g.promise}a.email=c.email}}return h.$login("password",{email:a.email,password:a.password,rememberMe:!0,debug:e.DEBUG})},loginSocial:function(a){return h.$login(a,{rememberMe:!0,scope:"google"===a?"https://www.googleapis.com/auth/userinfo.profile":"facebook"===a?"email":null,oauth_token:"twitter"===a?"true":null,preferRedirect:!1})},logout:function(){h.$logout()},"delete":function(a){return h.$removeUser(a.email,a.password,function(a){return null===a?console.info("User removed successfully"):(toastr.log("Error removing user: "+a.message),console.error("Error removing user:",a)),a})},sendPasswordResetEmail:function(a){return h.$sendPasswordResetEmail(a).then(null,function(a){return a})}};return a.signedIn=function(){return i.signedIn()},a.hasRole=function(a){return i.hasRole(a)},i}]),app.factory("Order",["$firebase","FIREBASE_URL","User",function(a,b,c){var d=new Firebase(b+"orders"),e=a(d),f={all:e,create:function(a){if(c.signedIn()){var b=c.getCurrent();return a.owner=b.username,e.$add(a).then(function(a){var c=a.name();return b.$child("orders").$child(c).$set(c),c})}},find:function(a){return e.$child(a)},"delete":function(a){if(c.signedIn()){var b=f.find(a);b.$on("loaded",function(){var d=c.findByUsername(b.owner);e.$remove(a).then(function(){d.$child("orders").$remove(a)})})}},addItem:function(a,b){if(c.signedIn()){var d=c.getCurrent();b.username=d.username,b.orderId=a,e.$child(a).$child("items").$add(b).then(function(b){d.$child("items").$child(b.name()).$set({id:b.name(),orderId:a})})}},deleteItem:function(a,b,d){if(c.signedIn()){var e=c.findByUsername(b.username);a.$child("items").$remove(d).then(function(){e.$child("items").$remove(d)})}}};return f}]),app.factory("Customer",["$firebase","CFG","User","$q",function(a,b,c,d){var e=new Firebase(b.FIREBASE_URL+"customers"),f=a(e),g=new Firebase(b.FIREBASE_URL+"customersByName"),h=a(g),i={all:f,create:function(a){return f.$add(a).then(function(b){var c=b.name();return h.$child(a.name.toLowerCase()).$set(c),console.info("customersByName:",h),c})},set:function(a,b){var c=f.$child(a).name;return b.name!==c&&h.$remove(c),h.$child(b.name.toLowerCase()).$set(a),delete b.$id,f.$child(a).$set(b)},find:function(a){return f.$child(a)},findByName:function(a){return a?h[a.toLowerCase()]:void 0},"delete":function(a){if(!a.$id){console.error("CUSTOMER WITHOUT $ID:",a);var b=d.defer();return b.resolve("No such customer"),b.promise}return f.$child(a.$id).$child("deleted").$set(!0).then(function(){return console.info("remove - then - success",a),h.$remove(a.name.toLowerCase()),null},function(a){return console.info("remove - then - error:",a.code),a.code})}};return i}]),app.factory("Servicereport",["$firebase","CFG","User",function(a,b,c){var d=new Firebase(b.FIREBASE_URL+"servicereports"),e=a(d),f={all:e,create:function(a){var b=c.getCurrent();return a.operator=b.username,e.$add(a).then(function(a){var b=a.name();return b})},set:function(a,b){return delete b.$id,e.$child(a).$set(b)},find:function(a){return e.$child(a)},getNumberNext:function(){var a=e.$child("stash").serviceReportNumber;return a=a?a:1},setNumberNext:function(){var a=e.$child("stash").serviceReportNumber;return a=a?a+1:1,e.$child("stash").$set({serviceReportNumber:a}),a},resetNumberNext:function(){var a=e.$child("stash").serviceReportNumber;return a=a&&a>1?a-1:1,e.$child("stash").$set({serviceReportNumber:a}),a},"delete":function(a){return console.info("deleting servicereport",a),console.info("set delete to true servicereport with id:",a.$id),e.$child(a.$id).$child("deleted").$set(!0).then(function(){return null},function(a){return a.code})}};return f}]),app.factory("User",["$rootScope","$firebase","$q","CFG","md5",function(a,b,c,d,e){var f=new Firebase(d.FIREBASE_URL+"users"),g=b(f),h=new Firebase(d.FIREBASE_URL+"usersByName"),i=b(h),j="http://www.gravatar.com/avatar/",k={all:g,create:function(a,b){if(console.info("User - create() - user:",a),!a.uid)return console.error("can't create a user without a uid!"),!1;a.username||(a.username=a.displayName),a.md5Hash=a.md5_hash,"google"===a.provider&&(a.email=a.email,a.imageUrl=a.thirdPartyUserData.picture),"facebook"===a.provider&&(a.email=a.thirdPartyUserData.email,a.imageUrl=a.thirdPartyUserData.picture.data.url),"twitter"===a.provider&&(a.email=null,a.imageUrl=a.thirdPartyUserData.entities.profile_image_url),a.imageUrl||(a.imageUrl=j,a.email&&(a.md5Hash||(a.md5Hash=e.createHash(a.email)),a.imageUrl+=a.md5Hash)),a.password=b;var c=!1;a.email===d.SYSTEM_EMAIL&&(c=!0);var f={users:{read:c,write:c},customers:{read:c,write:c},orders:{read:c,write:c},servicereports:{read:c,write:c}};return g[a.uid]={imageUrl:a.imageUrl,email:a.email,password:a.password,username:a.username,provider:a.provider,id:a.id,uid:a.uid,isTemporaryPassword:a.isTemporaryPassword,roles:f},a.username&&i.$child(a.username.toLowerCase()).$set(a.uid),g.$save(a.uid)},set:function(a,b){console.log("set user:",b);var c=g.$child(a).username;return b.username!==c&&i.$remove(c),i.$child(b.username.toLowerCase()).$set(a),delete b.$id,g.$child(a).$set(b)},findByUsername:function(a){return a?g[i[a.toLowerCase()]]:void 0},find:function(a){return g.$child(a)},getCurrent:function(){return a.currentUser},"delete":function(a){if(!a.$id){console.error("USER WITHOUT $ID:",a);var b=c.defer();return b.resolve("No such user"),b.promise}return g.$child(a.$id).$child("deleted").$set(!0).then(function(){return console.info("remove - then - success",a),i.$remove(a.username.toLowerCase()),i.$child("_"+a.username.toLowerCase()).$set(a.uid),null},function(a){return console.info("remove - then - error:",a.code),a.code})},undelete:function(a){if(!a.$id){console.error("USER WITHOUT $ID:",a);var b=c.defer();return b.resolve("No such user"),b.promise}return g.$child(a.$id).$remove("deleted").then(function(){return console.info("undelete - then - success",a),i.$remove("_"+a.username.toLowerCase()),i.$child(a.username.toLowerCase()).$set(a.uid),null},function(a){return console.info("remove - then - error:",a.code),a.code})},signedIn:function(){return void 0!==a.currentUser},setCurrentUser:function(b){a.currentUser=b},resetCurrentUser:function(){delete a.currentUser}};return a.$on("$firebaseSimpleLogin:login",function(a,b){if(console.warn("$rootScope.$on($firebaseSimpleLogin:login) FIRED - authUser:",b),!b.uid)return toastr.error("Error logging in user"),console.error("login fired with an authorized user with no uid!",b),k.resetCurrentUser();var c=k.find(b.uid);c&&k.setCurrentUser(c)}),a.$on("$firebaseSimpleLogin:logout",function(){k.resetCurrentUser()}),k}]),app.factory("Toaster",["$timeout",function(a){function b(a){d[a]=""}function c(){for(var a="",b=0;b<arguments.length;b++)a+=(b>0?" ":"")+JSON.stringify(arguments[b]);return a.replace(/^"/g,"").replace(/"$/g,"").replace(/\\/g,"")}toastr.options={closeButton:!1,debug:!1,positionClass:"toast-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"3500",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var d=[];return{success:function(){var e=c.apply(this,arguments);d.success!==e&&(toastr.success(e),a(function(){b("success")},toastr.options.timeOut,!1),d.success=e)},info:function(){var e=c.apply(this,arguments);d.info!==e&&(toastr.info(e),a(function(){b("info")},toastr.options.timeOut,!1),d.info=e)},warning:function(){var e=c.apply(this,arguments);d.warning!==e&&(toastr.warning(e),a(function(){b("warning")},toastr.options.timeOut,!1),d.warning=e)},error:function(){var e=c.apply(this,arguments);d.error!==e&&(toastr.error(e),a(function(){b("error")},toastr.options.timeOut,!1),d.error=e)}}}]),app.factory("DateTime",function(){function a(a){void 0===a&&(this.date=new Date),this.date="[object Date]"===Object.prototype.toString.call(a)?a:new Date(a)}return a.prototype.get=function(){return this.date},a.prototype.addHours=function(a){this.date.setHours(this.date.getHours()+parseInt(a))},a.prototype.addMinutes=function(a){this.date.setMinutes(this.date.getMinutes()+parseInt(a))},a}),app.factory("I18N",["$rootScope","$window","$route","CFG","gettext","gettextCatalog","tmhDynamicLocale",function(a,b,c,d,e,f,g){var h="en";a.$on("$localeChangeSuccess",function(){c.reload()});var i={t:function(a){return e(a)},getSupportedLanguages:function(){return{en:{name:"English",flag:"icons/flags/en.png",angularLocaleScript:"scripts/18n/angular-locale_en.js"},de:{name:"Deutsch",flag:"icons/flags/de.png",angularLocaleScript:"scripts/18n/angular-locale_de.js"},es:{name:"Español",flag:"icons/flags/es.png",angularLocaleScript:"scripts/18n/angular-locale_es.js"},fr:{name:"Français",flag:"icons/flags/fr.png",angularLocaleScript:"scripts/i18n/angular-locale_fr.js"},it:{name:"Italiano",flag:"icons/flags/it.png",angularLocaleScript:"scripts/i18n/angular-locale_it.js"}}},getDefaultLanguage:function(){return h},getBrowserLanguage:function(){return b.navigator.userLanguage||b.navigator.language},getCurrentLanguage:function(){return this.currentLanguage?this.currentLanguage:this.getDefaultLanguage()},getCurrentLanguageName:function(){return this.getSupportedLanguages()[this.getCurrentLanguage()].name},getCurrentLanguageFlag:function(){return this.getSupportedLanguages()[this.getCurrentLanguage()].flag},getCurrentLanguageScript:function(){return this.getSupportedLanguages()[this.getCurrentLanguage()].script},setCurrentLanguage:function(a){var b=this.currentLanguage;if(a)this.currentLanguage=this.getSupportedLanguages()[a]?a:this.getDefaultLanguage();else if(this.browserLanguage=this.getBrowserLanguage(),this.currentLanguage=this.getDefaultLanguage(),this.browserLanguage)if(this.getSupportedLanguages()[this.browserLanguage])this.currentLanguage=this.browserLanguage;else{var c=this.browserLanguage.replace(/-.*$/,"");this.getSupportedLanguages()[c]&&(this.currentLanguage=c)}return b!==this.currentLanguage&&(f.debug=d.DEBUG,f.setCurrentLanguage(this.currentLanguage),g.set(this.currentLanguage)),this.currentLanguage},setNextLanguage:function(){var a=this.getSupportedLanguages(),b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);b.sort();for(var d,e=0;e<b.length;e++)if(b[e]===this.currentLanguage){d=b[++e>=b.length?0:e];break}return this.setCurrentLanguage(d)}};return i}]),app.directive("navCollapse",function(){return{restrict:"A",link:function(a,b){var c=!1;b.on("show.bs.collapse",function(){c=!0}),b.on("hide.bs.collapse",function(){c=!1}),b.on("click",function(){c&&"auto"===b.css("overflow-y")&&b.collapse("hide")})}}}),app.directive("autofillFix",function(){return{require:"ngModel",link:function(a,b,c,d){a.$on("autofillFix:update",function(){d.$setViewValue(b.val())})}}}),app.directive("autofocus",["$timeout",function(a){return{replace:!1,link:function(b,c,d){b.$watch(d.autofocus,function(b){b&&a(function(){c[0].focus()})})}}}]),app.directive("equals",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){a.$watch(c.ngModel,function(){e()}),c.$observe("equals",function(){e()});var e=function(){var a=d.$viewValue,b=c.equals;d.$setValidity("equals",!(a&&b)||a===b)}}}}}),app.directive("reallyClick",["$modal",function(a){return{restrict:"A",scope:{reallyClick:"&",item:"="},link:function(b,c,d){c.bind("click",function(){var c=d.reallyMessage||"Are you sure?",e='<div class="modal-body">'+c+"</div>";e+='<div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">OK</button><button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>';var f=a.open({template:e,controller:"ModalInstanceCtrl"});f.result.then(function(){b.reallyClick({item:b.item})},function(){})})}}}]),app.directive("checkUserName",function(){return{require:"ngModel",scope:{value:"=ngModel"},link:function(a,b,c,d){var e=/^[^_.$\[\]#\/][^.$\[\]#\/]*$/;d.$parsers.unshift(function(a){var b,c;return a||(d.$setValidity("required",!1),c=null),e.test(a)?b?(d.$setValidity("taken",!1),d.$setValidity("invalid",!0)):(d.$setValidity("taken",!0),d.$setValidity("invalid",!0),c=a):(d.$setValidity("taken",!0),d.$setValidity("invalid",""===a)),c}),b.bind("blur",function(){d.$viewValue&&(d.$viewValue=capitalize(d.$viewValue),d.$render())})}}}),app.directive("checkDuration",function(){return{require:"ngModel",scope:{value:"=ngModel"},link:function(a,b,c,d){var e,f=/^\d+$/,g=/^\d+[:.]\d+$/;d.$parsers.unshift(function(a){var b=-1,c=-1;if(f.test(a))b=parseInt(a),c=0;else if(g.test(a)){var h=a.split(/\s*[:.]\s*/);b=parseInt(h[0]),c=parseInt(h[1]),c>=60&&(b=c=-1)}var i=60*b+c;return i>0?(d.$setValidity("duration",!0),e=a):d.$setValidity("duration",!1),e}),b.bind("blur",function(){d.$viewValue&&(d.$viewValue=formatDuration(d.$viewValue),d.$render())})}}}),app.directive("checkCustomerName",["Customer",function(a){return{require:"ngModel",scope:{value:"=ngModel"},link:function(b,c,d,e){var f,g=/^([ \u00c0-\u01ffa-zA-Z0-9\'\.\,\-\/\&])+$/;e.$parsers.unshift(function(b){if(g.test(b)){var c=d.customerId,h=a.findByName(b);h&&h!==c?(e.$setValidity("taken",!1),e.$setValidity("invalid",!0)):(e.$setValidity("taken",!0),e.$setValidity("invalid",!0),f=b)}else e.$setValidity("taken",!0),e.$setValidity("invalid",!1),b||(e.$setValidity("required",!1),f=b);return f}),c.bind("blur",function(){e.$viewValue&&(e.$viewValue=capitalize(e.$viewValue),e.$render())})}}}]),app.directive("checkEmail",function(){return{require:"ngModel",scope:{value:"=ngModel"},link:function(a,b,c,d){var e,f=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;d.$parsers.unshift(function(a){return f.test(a)?(d.$setValidity("invalid",!0),e=a):(d.$setValidity("invalid",!1),a||(d.$setValidity("required",!1),e=a)),e}),b.bind("blur",function(){d.$viewValue&&(d.$viewValue=d.$viewValue.toLowerCase(),d.$render())})}}}),app.directive("checkPassword",function(){return{require:"ngModel",link:function(a,b,c,d){var e;d.$parsers.unshift(function(a){return a.length>=1?(d.$setValidity("invalid",!0),e=a):d.$setValidity("invalid",!1),e})}}}),app.directive("checkPhone",function(){return{require:"ngModel",scope:{value:"=ngModel"},link:function(a,b,c,d){var e,f=/^[\s()+-]*([0-9][\s()+-]*){6,20}$/;d.$parsers.unshift(function(a){return f.test(a)?(d.$setValidity("invalid",!0),e=a):d.$setValidity("invalid",!1),a||(d.$setValidity("required",!1),e=null),e}),b.bind("blur",function(){var a=d.$viewValue;if(a){var b="3",c=3;a.length>c&&a.substr(0,1)===b&&(a=a.replace(/[^0-9]/g,""),a=[a.slice(0,c)," ",a.slice(c)].join(""),d.$viewValue=a,d.$render())}})}}}),app.directive("checkCfOrPiva",function(){return{require:"ngModel",scope:{value:"=ngModel"},link:function(a,b,c,d){var e=16,f=11;d.$parsers.unshift(function(a){var b,c,g,h,i,j=null;if(!a||a.length!==e&&a.length!==f)j="norcfnorpiva";else{if(a.length===e){for(a=a.toUpperCase(),c="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",g=0;16>g;g++)if(-1===c.indexOf(a.charAt(g))){j="cfinvalidchar";break}if(!j){var k="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",l="ABCDEFGHIJABCDEFGHIJKLMNOPQRSTUVWXYZ",m="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n="BAKPLCQDREVOSFTGUHMINJWZYX";for(i=0,g=1;13>=g;g+=2)i+=m.indexOf(l.charAt(k.indexOf(a.charAt(g))));for(g=0;14>=g;g+=2)i+=n.indexOf(l.charAt(k.indexOf(a.charAt(g))));i%26!==a.charCodeAt(15)-"A".charCodeAt(0)&&(j="cfcrcwrong")}}if(a.length===f){for(c="0123456789",g=0;11>g;g++)if(-1===c.indexOf(a.charAt(g))){j="pivainvalidchar";break}for(i=0,g=0;9>=g;g+=2)i+=a.charCodeAt(g)-"0".charCodeAt(0);for(g=1;9>=g;g+=2)h=2*(a.charCodeAt(g)-"0".charCodeAt(0)),h>9&&(h-=9),i+=h;(10-i%10)%10!==a.charCodeAt(10)-"0".charCodeAt(0)&&(j="pivacrcwrong")}}return a||(d.$setValidity("required",!1),b=null),j?d.$setValidity(j,!1):(d.$setValidity("norcfnorpiva",!0),d.$setValidity("cfinvalidchar",!0),d.$setValidity("cfcrcwrong",!0),d.$setValidity("pivainvalidchar",!0),d.$setValidity("pivacrcwrong",!0),b=a),b}),b.bind("blur",function(){d.$viewValue&&(d.$viewValue=d.$viewValue.toUpperCase(),d.$render())})}}});var KEYCODE_SHIFT=16,KEYCODE_ALT=18,KEYCODE_CTRL=11,KEYCODE_CAPSLOCK=20,KEYCODE_ENTER=13,KEYCODE_ESCAPE=27,KEYCODE_TAB=9,KEYCODE_BACKSPACE=8,KEYCODE_DELETE=46,KEYCODE_END=35,KEYCODE_FUNCTION_ARROW_LEFT=37,KEYCODE_FUNCTION_ARROW_UP=38,KEYCODE_FUNCTION_ARROW_RIGHT=39,KEYCODE_FUNCTION_ARROW_DOWN=40,KEYCODE_FUNCTION_PAGE_UP=33,KEYCODE_FUNCTION_PAGE_DOWN=34,KEYCODE_FUNCTION_KEY_F1=112,KEYCODE_FUNCTION_KEY_F2=113,KEYCODE_FUNCTION_KEY_F3=114,KEYCODE_FUNCTION_KEY_F4=115,KEYCODE_FUNCTION_KEY_F5=116,KEYCODE_FUNCTION_KEY_F6=117,KEYCODE_FUNCTION_KEY_F7=118,KEYCODE_FUNCTION_KEY_F8=119,KEYCODE_FUNCTION_KEY_F9=120,KEYCODE_FUNCTION_KEY_F10=121,KEYCODE_FUNCTION_KEY_F11=122,KEYCODE_FUNCTION_KEY_F12=123;app.directive("keyEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){b.which===KEYCODE_ENTER&&(a.$apply(function(){a.$eval(c.keyEnter)}),b.preventDefault())})}}),app.directive("keyEscape",function(){return function(a,b,c){b.bind("keydown keypress",function(b){b.which===KEYCODE_ESCAPE&&(a.$apply(function(){a.$eval(c.keyEscape)}),b.preventDefault())})}}),app.directive("keyF1",function(){return function(a,b,c){b.bind("keydown keypress",function(b){b.which===KEYCODE_FUNCTION_KEY_F1&&(a.$apply(function(){a.$eval(c.keyF1)}),b.preventDefault())})}}),app.directive("spring",["$window",function(a){return{link:function(b,c,d){var e=$("body").find("#"+d.spring)[0],f=angular.element(a),g=0,h=3;
"undefined"!=typeof e&&(g=h+e.clientHeight),b.getWindowHeight=function(){return{windowHeight:f.innerHeight(),topHeight:c[0].offsetTop,bottomHeight:g}},b.$watch(b.getWindowHeight,function(a){var b=a.windowHeight,d=a.topHeight,e=a.bottomHeight,f=b-(d+e);c.css({height:f})},!0),f.bind("resize",function(){b.$apply()})}}}]),app.directive("showDeviceClass",["$window",function(a){return{link:function(b,c){var d=angular.element(a);b.getWindowWidth=function(){return d.width()},b.$watch(b.getWindowWidth,function(a){var b=a,d="huge";1200>=b&&(d="wide"),992>=b&&(d="desktop"),768>=b&&(d="tablet"),480>=b&&(d="phone"),320>=b&&(d="custom"),c.html('<span class="debug">width: '+b+"px&nbsp;device: "+d+"</span>")},!0),d.bind("resize",function(){b.$apply()})}}}]),app.filter("hostnameFromUrl",function(){return function(a){var b=document.createElement("a");return b.href=a,b.hostname}}),app.filter("searchServiceReport",function(){return function(a,b,c){var d=[];if(a&&c){var e=new RegExp(".*"+c+".*","ig");for(var f in a){var g=a[f],h=a[f].customerId?b[a[f].customerId]:null;(e.test(g.dateIn)||e.test(g.notes)||h&&(e.test(h.name)||e.test(h.address)))&&d.push(a[f])}return d}return a}});